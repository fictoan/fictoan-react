import e,{useState as t,useCallback as r,useEffect as o,createRef as n}from"react";import{E as l}from"../../external/Element.js";import{InputField as s}from"../Form/InputField/InputField.js";import{PinInputStyled as a}from"./PinInputField.styled.js";import"../Form/BaseInputComponent/BaseInputComponent.js";import"../Form/InputLabel/InputLabel.js";import"../Form/FormItem/FormItem.js";import"../Form/FormItem/FormItem.styled.js";import"styled-components";import"../Form/InputField/InputField.styled.js";import"../Form/Select/Select.styled.js";import"../Form/TextArea/TextArea.styled.js";import"../../external/theme.js";import"../../external/DefaultColours.js";function m(e,t){return("alphanumeric"===t?/^[a-zA-Z0-9]+$/i:/^[0-9]+$/).test(e)}const u=/*#__PURE__*/e.forwardRef((({numberOfFields:u,onChange:i,type:p="number",mask:c=!1,otp:f=!1,autoFocus:d=!1,spacing:F="small"},g)=>{const[h,y]=t([]),[v,j]=t([]),[I,A]=t(!0),[x,b]=t(-1),k=r((e=>{var t;const r=h[e];null===(t=null==r?void 0:r.current)||void 0===t||t.focus()}),[h]);o((()=>{y((e=>{const t=Array(u).fill(0).map(((t,r)=>{var o;const l=e[r]||/*#__PURE__*/n();return d&&0===r&&(null===(o=l.current)||void 0===o||o.focus()),l}));return t}))}),[u,d]);const C=r((e=>{if(!I)return;const t=e+1<u?e+1:null;t&&k(t)}),[k,u,I]),w=r(((e,t)=>{const r=[...v];r[t]=e,j(r),null==i||i(r.join(""));""!==e&&r.length===u&&r.every((e=>null!=e&&""!==e))||C(t)}),[C,u,i,v]),E=r(((e,t)=>{let r=t;return(null==e?void 0:e.length)>0&&(e[0]===t.charAt(0)?r=t.charAt(1):e[0]===t.charAt(1)&&(r=t.charAt(0))),r}),[]),B=()=>{b(-1)};let T=[];return F&&T.push(`spacing-${F}`),/*#__PURE__*/e.createElement(l,{as:a,classNames:T,ref:g},[...Array(u)].map(((t,r)=>/*#__PURE__*/e.createElement(s,{key:r,className:"pin-input-field",ref:h[r],type:c?"password":"number"===p?"tel":"text",inputMode:"number"===p?"numeric":"text",onChange:e=>((e,t)=>{const r=e.currentTarget.value,o=v[t],n=E(o,r);if(""!==n)if(r.length>1&&t<u-1){if(m(r,p)){const e=r.split("").filter(((e,t)=>t<u));j(e),k(t+e.length<u?t+e.length:u-1),null==i||i(e.join(""))}}else m(n,p)&&w(n,t),A(!0);else w("",t)})(e,r),onKeyDown:e=>((e,t)=>{var r;if("Backspace"===e.key)if(""===e.target.value){if(t>0){const e=t-1;w("",e),k(e),A(!0)}}else A(!1);else"Escape"===e.key?(null===(r=h[t].current)||void 0===r||r.blur(),B()):"ArrowRight"===e.key?t<u-1&&k(t+1):"ArrowLeft"===e.key&&t>0&&k(t-1)})(e,r),onFocus:e=>((e,t)=>{b(t),setTimeout((()=>{e.target.setSelectionRange(e.target.value.length,e.target.value.length)}),0)})(e,r),onBlur:B,placeholder:x!==r?"‚¶Å":void 0,autoComplete:f?"one-time-code":"off",value:v[r]||"",autoFocus:d&&0===r}))))}));export{u as PinInputField};
//# sourceMappingURL=PinInputField.js.map
